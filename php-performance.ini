; PHP Memory
memory_limit = 512M
max_execution_time = 300
max_input_vars = 5000
upload_max_filesize = 64M
post_max_size = 128M
max_input_time = 300

; Error Handling
error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT
display_errors = Off
log_errors = On
error_log = /dev/stderr

; OPcache production settings
opcache.enable=1
opcache.enable_cli=1
opcache.validate_timestamps=0
opcache.memory_consumption=256
opcache.max_accelerated_files=20000
opcache.interned_strings_buffer=16
opcache.jit=1255
opcache.jit_buffer_size=64M
opcache.revalidate_freq=0
opcache.fast_shutdown=1
opcache.save_comments=1
opcache.optimization_level=0xFFFFFFF

; Realpath cache
realpath_cache_size=4096k
realpath_cache_ttl=600

; Session handling
session.save_handler=redis
session.gc_maxlifetime=86400
session.cookie_lifetime=0
session.gc_probability=1
session.gc_divisor=1000

; Output Buffering
output_buffering=4096
implicit_flush=Off

; Zend Optimizations
zend.enable_gc=1
zend.multibyte=On
date.timezone=UTC

; PHP 8.4 Optimizations
opcache.preload=/var/www/html/wp-includes/load.php
opcache.preload_user=www-data
opcache.file_cache=/tmp/opcache
opcache.file_cache_consistency_checks=0
ffi.enable=true
opcache.jit_prof_threshold=0.001

; Networking
default_socket_timeout=60

; MySQL
mysql.allow_persistent=On
mysql.connect_timeout=60
mysql.max_persistent=-1
mysql.max_links=-1

; Security
expose_php=Off
disable_functions=exec,passthru,shell_exec,system,proc_open,popen,parse_ini_file,show_source
session.cookie_httponly=1
session.cookie_secure=1
session.cookie_samesite="Strict"
variables_order="EGPCS"
request_order="GP"
enable_dl=Off
allow_url_fopen=Off
allow_url_include=Off
mail.add_x_header=Off
